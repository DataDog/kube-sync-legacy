name: build-and-test
on:
  - pull_request

permissions:
  contents: read

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # v4
    - name: Set up Go
      uses: actions/setup-go@41dfa10bad2bb2ae585af6ee5bb4d7d973ad74ed # v5
      with:
        go-version: 1.22.0
    - name: Build
      run: |
        make kube-sync-docker
    - name: Test
      shell: bash
      run: |
        ./.ci/setup-kind.sh
        ./.ci/setup-e2e.sh
        ./.ci/run-e2e.sh
